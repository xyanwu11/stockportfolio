# 📊 投資組合分析系統

一個基於Streamlit的interactive投資組合分析網頁介面，用於比較高報酬策略與低風險策略的投資績效。

## 🚀 主要功能

### 1. 🏠 首頁
- **投資組合總覽**：顯示兩種策略的成分股與權重
- **產業分布圖**：視覺化投資組合的產業配置
- **數據載入狀態**：即時顯示數據獲取進度

### 2. 📈 績效分析頁
- **累積報酬圖**：使用Plotly interactive圖表比較策略表現
- **關鍵指標卡片**：年化報酬率、夏普比率、最大回撤、波動率
- **與0050 ETF比較**：基準比較分析表格

### 3. ⚠️ 風險分析頁
- **波動率走勢**：30天滾動年化波動率圖表
- **回撤分析**：最大回撤時間序列視覺化
- **VaR分析**：風險價值分布圖與95%信心水準

### 4. 🔄 比較分析頁
- **策略對比表**：兩種策略的全面績效比較
- **多維度雷達圖**：視覺化各項指標的相對表現
- **GPT智能分析**：深度投資組合問題診斷與最適策略建議
- **時間穩定性分析**：檢視策略在不同時期的表現一致性
- **相關性分析**：股票間相關性熱圖與風險分散評估

## 🛠️ 技術特色

- **模組化架構**：分離核心分析、圖表繪製、GPT分析等功能模組
- **智能啟動**：start.py提供自動檢查和瀏覽器啟動功能
- **GPT分析模組**：深度投資組合問題診斷與建議系統
- **進階圖表**：相關性熱圖、多維度視覺化分析
- **性能監控**：即時監控系統資源使用與載入時間
- **快取機制**：使用`@st.cache_data`優化數據載入效能
- **配置管理**：集中化系統設定與參數配置
- **中文支援**：完整的繁體中文介面
- **響應式設計**：適配不同螢幕尺寸
- **Interactive圖表**：Plotly提供豐富的互動功能
- **實時數據**：透過yfinance獲取最新股價數據
- **日誌系統**：完整的操作記錄與錯誤追蹤

## 📦 安裝與使用

### 1. 安裝相依套件
```bash
pip install -r requirements.txt
```

### 2. 啟動應用程式

**方法1：推薦使用啟動腳本（自動開啟瀏覽器）**
```bash
python start.py
```

**方法2：使用批次檔案（Windows）**
```bash
run_app.bat
```

**方法3：使用PowerShell腳本**
```bash
.\run_app.ps1
```

**方法4：命令列手動啟動**
```bash
python -m streamlit run app.py
```
### 3. 訪問介面
打開瀏覽器訪問：http://localhost:8501

## 📁 檔案結構

```
stockportfolio/
├── app.py                              # 主Streamlit應用程式
├── start.py                            # 應用程式啟動入口
├── config.py                           # 系統配置設定
├── portfolio_analysis.py              # 核心績效分析模組
├── gpt_analysis.py                     # GPT智能分析功能
├── advanced_charts.py                 # 進階圖表繪製
├── utils.py                           # 工具函數
├── performance_monitor.py             # 性能監控模組
├── test_app.py                        # 應用程式測試
├── emoji_test.py                      # 表情符號測試
├── great reward.xlsx                  # 高報酬策略投資組合
├── low risk.xlsx                     # 低風險策略投資組合
├── run_app.bat                       # Windows批次啟動腳本
├── run_app.ps1                       # PowerShell啟動腳本
├── requirements.txt                  # Python相依套件清單
├── portfolio_analysis.log            # 系統日誌檔案
├── OPTIMIZATION_GUIDE.md             # 系統優化指南
└── README.md                        # 專案說明文件
```

## 🎯 系統特色

### 📊 動態分析功能
- **即時數據更新**：自動獲取最新股價進行分析
- **彈性時間範圍**：支援自定義回測期間
- **多維度比較**：全方位策略績效評估
- **智能建議系統**：GPT驅動的投資組合診斷

### 🎨 互動式介面
- **側邊欄控制**：日期範圍選擇、頁面導航
- **即時重算**：參數調整後自動更新結果
- **多語言支援**：完整繁體中文介面
- **響應式設計**：適配各種螢幕尺寸

## 🔧 系統配置

### 主要設定檔案
- **`config.py`**：集中化系統配置管理
- **`app.py`**：Streamlit應用程式主邏輯
- **`start.py`**：智能啟動腳本

### 可自定義參數
```python
# 在 config.py 或相關模組中調整
- 預設分析期間
- 績效指標權重
- 圖表樣式設定
- 快取策略配置
```

## 📈 核心分析指標

- **夏普比率 (Sharpe Ratio)**：風險調整後報酬效率
- **最大回撤 (Max Drawdown)**：投資期間最大虧損幅度
- **索提諾比率 (Sortino Ratio)**：僅考慮下跌風險的報酬比率
- **VaR (Value at Risk)**：特定信心水準下的最大可能損失
- **勝率 (Win Rate)**：獲利交易日佔比
- **年化報酬率**：複合年增長率
- **波動率**：報酬率標準差

---

*本系統使用Yahoo Finance API獲取即時股價數據，請確保網路連接正常。*