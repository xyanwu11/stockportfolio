# 📊 投資組合分析系統

一個基於Streamlit的interactive投資組合分析網頁介面，用於比較高報酬策略與低風險策略的投資績效。

## 🚀 主要功能

### 1. 🏠 首頁
- **投資組合總覽**：顯示兩種策略的成分股與權重
- **產業分布圖**：視覺化投資組合的產業配置
- **數據載入狀態**：即時顯示數據獲取進度

### 2. 📈 績效分析頁
- **累積報酬圖**：使用Plotly interactive圖表比較策略表現
- **關鍵指標卡片**：年化報酬率、夏普比率、最大回撤、波動率
- **與0050 ETF比較**：基準比較分析表格

### 3. ⚠️ 風險分析頁
- **波動率走勢**：30天滾動年化波動率圖表
- **回撤分析**：最大回撤時間序列視覺化
- **VaR分析**：風險價值分布圖與95%信心水準

### 4. 🔄 比較分析頁
- **策略對比表**：兩種策略的全面績效比較
- **多維度雷達圖**：視覺化各項指標的相對表現
- **GPT最適策略建議**：基於綜合評分的智能推薦

## 🛠️ 技術特色

- **快取機制**：使用`@st.cache_data`優化數據載入效能
- **中文支援**：完整的繁體中文介面
- **響應式設計**：適配不同螢幕尺寸
- **Interactive圖表**：Plotly提供豐富的互動功能
- **實時數據**：透過yfinance獲取最新股價數據

## 📦 安裝與使用

### 1. 安裝相依套件
```bash
pip install -r requirements.txt
```

### 2. 啟動應用程式

**方法1：使用批次檔案（Windows）**
```bash
run_app.bat
```

**方法2：命令列啟動**
```bash
streamlit run app.py
```
現在試試看 .\run_app.ps1 或 python -m streamlit run app.py
### 3. 訪問介面
打開瀏覽器訪問：http://localhost:8501

## 📁 檔案結構

```
stockportfolio/
├── app.py                              # 主應用程式
├── portfolio_analysis.py              # 績效分析腳本
├── great reward.xlsx                  # 高報酬策略投資組合
├── low risk.xlsx                     # 低風險策略投資組合
├── run_app.bat                       # Windows啟動腳本
├── requirements.txt                  # 相依套件清單
└── README.md                        # 說明文件
```

## 🎯 分析結果摘要

根據2020-2024年回測結果：

| 指標 | 高報酬策略 | 低風險策略 | 優勝者 |
|------|-----------|-----------|---------|
| 年化報酬率 | 32.55% | 23.26% | 高報酬 |
| 夏普比率 | 1.29 | **1.36** | **低風險** |
| 最大回撤 | -34.78% | **-25.51%** | **低風險** |
| 勝率 | 52.35% | **54.13%** | **低風險** |

**🏆 建議採用：低風險策略**
- 綜合評分：0.9298 vs 0.8692
- 更佳的風險調整報酬
- 較佳的下跌保護能力

## 📊 側邊欄功能

- **日期範圍選擇**：自定義回測期間
- **頁面導航**：快速切換分析頁面
- **即時計算**：參數調整後自動重新計算

## 🔧 自定義設定

您可以修改`app.py`中的以下參數：

```python
# 預設日期範圍
start_date = datetime(2020, 1, 1)
end_date = datetime.now()

# 綜合評分權重
gr_score = (夏普比率 * 0.4 + 回撤控制 * 0.3 + 勝率 * 0.3)
```

## 📈 技術指標說明

- **夏普比率**：衡量風險調整後報酬的效率
- **最大回撤**：投資期間的最大虧損幅度
- **VaR (95%)**：95%信心水準下的最大可能損失
- **索提諾比率**：僅考慮下跌風險的報酬比率

---

*本系統使用Yahoo Finance API獲取即時股價數據，請確保網路連接正常。*